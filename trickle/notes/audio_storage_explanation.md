# 音频存储和下载说明

## 音频存储位置

### 后端音频存储
当您点击"生成音频"功能时，系统会：
1. **生成音频**: 调用SoundOfText API生成高质量泰语语音
2. **下载MP3文件**: 自动下载音频文件到服务器本地存储
3. **保存到服务器**: MP3文件保存在`data/audio/`目录下
4. **创建索引**: 生成JSON元数据文件便于查找和管理

### 存储格式
**MP3文件**: `data/audio/卡片ID_单词类型.mp3`
**元数据文件**: `data/audio/卡片ID_单词类型.json`
```json
{
  "cardId": "123_word",
  "audioType": "word", 
  "audioUrl": "https://api.soundoftext.com/sounds/xxxx.mp3",
  "localFile": "123_word.mp3",
  "text": "สวัสดี",
  "createdAt": "2025-02-08T01:30:00.000Z"
}
```

## 下载功能说明

### "下载所有文件"按钮
点击此按钮时会下载：
1. **PNG图片文件**: `泰语单词_card_001.png` 格式
2. **单词音频**: `泰语单词_word.mp3` 格式  
3. **例句音频**: `泰语单词_example.mp3` 格式

### 音频下载来源
- **服务器MP3文件**: 优先使用服务器本地存储的MP3文件，播放速度快且稳定
- **缓存音频URL**: 使用浏览器缓存的音频链接作为备用
- **实时生成**: 如果没有预生成音频，会实时调用API生成
- **文件命名**: 使用泰语单词命名，方便在剪映等视频软件中匹配

### MP3文件存储优势
1. **播放稳定**: 本地文件不受网络波动影响
2. **加载速度快**: 服务器直接提供文件，无需第三方API
3. **永久保存**: 文件保存在服务器，不会过期失效
4. **批量处理**: 支持批量生成和下载，提高效率

## 音频播放问题排查

### 可能的原因
1. **网络问题**: 音频生成服务暂时不可用
2. **缓存问题**: 音频URL过期或失效
3. **API限制**: SoundOfText API达到使用限制

### 解决方案
1. **重新生成**: 在文件管理中重新点击"生成音频"
2. **检查网络**: 确保网络连接正常
3. **等待重试**: API服务恢复后自动恢复正常

## 使用建议

1. **批量生成**: 上传卡片后立即批量生成音频，确保后续学习时有音频
2. **定期检查**: 定期检查音频播放是否正常，及时重新生成失效音频
3. **备份下载**: 重要音频可以下载到本地备份